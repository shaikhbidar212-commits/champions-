<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Attendance</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{margin:0;font-family:Inter,Arial,sans-serif;background:#f3f4f6;color:#111827}
    .container{max-width:880px;margin:28px auto;padding:20px}
    .card{background:#fff;border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(8,15,35,0.08)}
    .header{display:flex;align-items:center;justify-content:space-between}
    .title{font-size:20px;font-weight:700}
    .profile{display:flex;gap:12px;align-items:center;padding:12px;background:#f9fafb;border-radius:10px;margin-bottom:14px}
    .profile .left{min-width:180px}
    .profile .right{flex:1}
    .muted{color:#6b7280}
    .options{display:flex;gap:12px;margin-bottom:12px}
    .option{padding:12px;background:#fff;border-radius:10px;flex:1;text-align:center;cursor:pointer;box-shadow:0 3px 10px rgba(2,6,23,0.05)}
    .subject-row{display:grid;grid-template-columns:1fr 2fr 1fr;gap:12px;padding:12px;border-bottom:1px solid #f3f4f6}
    .status{font-weight:700;padding:6px 8px;border-radius:8px;background:#fff7ed;color:#92400e;border:1px dashed #fcd34d;display:inline-block}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="header">
        <div class="title" id="branchTitle">Branch</div>
        <div><button onclick="goBack()">⟵ Back</button></div>
      </div>

      <!-- Student profile will render here -->
      <div id="studentProfile" class="profile" style="display:none;">
        <div class="left">
          <strong id="studentName">Student Name</strong><br>
          <div class="muted" id="studentRoll">Roll: -</div>
        </div>
        <div class="right">
          <div><strong>Father:</strong> <span id="studentFather"></span></div>
          <div><strong>Email:</strong> <span id="studentEmail"></span></div>
          <div><strong>Phone:</strong> <span id="studentPhone"></span></div>
        </div>
      </div>

      <div class="options">
        <div class="option" onclick="showAttendance()">Attendance</div>
      </div>

      <div id="attendanceWrap" style="display:none">
        <h3>Attendance — Subjects</h3>
        <div id="subjectsList" style="background:#fff;border-radius:8px;overflow:hidden"></div>
      </div>
    </div>
  </div>

<script>
  function getParam(n){ return new URLSearchParams(window.location.search).get(n); }
  const branchParam = (getParam("branch")||"other").toLowerCase();
  const branchName = decodeURIComponent(getParam("name")||branchParam.toUpperCase());
  const studentRoll = getParam("roll") || "";

  // full subjects (same definitions you asked earlier)
  const branchSubjects = {
    aiml: [
      { code: "", name: "(LA&C) Linear Algebra and Calculus" },
      { code: "", name: "(BCME) Basic Civil & Mechanical Engineering" },
      { code: "", name: "(IP) Introduction to Programming" },
      { code: "", name: "(CE) Communicative English" },
      { code: "", name: "(CHE) Chemistry" }
    ],
    cse: [
      { code: "", name: "(LA&C) Linear Algebra and Calculus" },
      { code: "", name: "(BCME) Basic Civil & Mechanical Engineering" },
      { code: "", name: "(IP) Introduction to Programming" },
      { code: "", name: "(CE) Communicative English" },
      { code: "", name: "(CHE) Chemistry" }
    ],
    ece: [
      { code: "", name: "(LA&C) Linear Algebra and Calculus" },
      { code: "", name: "(BCME) Basic Civil & Mechanical Engineering" },
      { code: "", name: "(IP) Introduction to Programming" },
      { code: "", name: "(CE) Communicative English" },
      { code: "", name: "(CHE) Chemistry" }
    ],
    other: [
      { code: "", name: "(LA&C) Linear Algebra and Calculus" },
      { code: "", name: "(IP) Introduction to Programming" },
      { code: "", name: "(EG) Engineering Graphics" },
      { code: "", name: "(PY) Physics" }
    ]
  };

  const subjects = branchSubjects[branchParam] || branchSubjects.other;
  document.getElementById("branchTitle").textContent = branchName;

  // render profile from localStorage demoStudent
  function renderProfile(){
    const s = localStorage.getItem("demoStudent");
    if(!s){ return; } // no data
    const stu = JSON.parse(s);

    // show profile only if email/roll matches query roll (best-effort)
    if(studentRoll && stu.rollNo && studentRoll !== stu.rollNo){
      // if roll mismatch, still show but note mismatch (you can change)
    }

    document.getElementById("studentProfile").style.display = "flex";
    document.getElementById("studentName").textContent = stu.fullName || "";
    document.getElementById("studentRoll").textContent = "Roll: " + (stu.rollNo || "");
    document.getElementById("studentFather").textContent = stu.fatherName || "";
    document.getElementById("studentEmail").textContent = stu.email || "";
    document.getElementById("studentPhone").textContent = stu.phone || "";
  }

  function renderSubjects(){
    const container = document.getElementById("subjectsList");
    container.innerHTML = "";
    subjects.forEach(s=>{
      const row = document.createElement("div");
      row.className = "subject-row";
      row.innerHTML = `
        <div><div class="muted">Subject Code</div><div class="field">${s.code||""}</div></div>
        <div><div class="muted">Subject Name</div><div class="field">${s.name}</div></div>
        <div style="display:flex;justify-content:flex-end;align-items:center"><span class="status">Not submitted</span></div>
      `;
      container.appendChild(row);
    });
  }

  function showAttendance(){
    document.getElementById("attendanceWrap").style.display = "block";
    renderSubjects();
  }

  function goBack(){ window.history.back(); }

  // init
  window.addEventListener('DOMContentLoaded', ()=>{
    renderProfile();
    // attendance hidden until clicked
  });
</script>
</body>
</html>
